2025-10-23 07:16:55,992 | INFO | Logging initialized. Log file: outputs\logs\run_20251023_071655.log
2025-10-23 07:16:55,992 | INFO | Configuration file: config.yaml
2025-10-23 07:16:55,992 | INFO | Reward families to process: homogeneous
2025-10-23 07:16:55,992 | INFO | MA-SPI iterations=3, episodes/stage=50, episode_length=100
2025-10-23 07:16:55,993 | INFO | MA-LfL reward epochs=1000, reward batch size=512
2025-10-23 07:16:55,993 | INFO | Log file located at outputs\logs\run_20251023_071655.log
2025-10-23 07:16:55,993 | INFO | Running experiment for reward family: homogeneous
2025-10-23 07:16:55,993 | INFO | [Experiment:homogeneous] Starting MA-SPI...
2025-10-23 07:16:56,905 | INFO | [MA-SPI] Starting run with 3 stages, 50 episodes/stage, episode length 100
2025-10-23 07:16:56,906 | INFO | [MA-SPI] Stage 1/3 - collecting trajectories...
2025-10-23 07:16:58,504 | INFO | [MA-SPI] Stage 1/3 - collected 10/50 episodes
2025-10-23 07:16:59,909 | INFO | [MA-SPI] Stage 1/3 - collected 20/50 episodes
2025-10-23 07:17:02,282 | INFO | [MA-SPI] Stage 1/3 - collected 30/50 episodes
2025-10-23 07:17:03,972 | INFO | [MA-SPI] Stage 1/3 - collected 40/50 episodes
2025-10-23 07:17:05,426 | INFO | [MA-SPI] Stage 1/3 - collected 50/50 episodes
2025-10-23 07:17:05,430 | INFO | [MA-SPI] Stage 1/3 - Agent 0 avg episode reward: -431.120 (std 24.046)
2025-10-23 07:17:05,430 | INFO | [MA-SPI] Stage 1/3 - Agent 1 avg episode reward: -411.020 (std 20.728)
2025-10-23 07:17:05,430 | INFO | [MA-SPI] Stage 1/3 - dataset size: 5000 transitions
2025-10-23 07:17:05,618 | INFO | [MA-SPI] Stage 1/3 - Q updates 2/10 (current batch 5000) [A0_Q_loss:1.0781, A1_Q_loss:0.7178]
2025-10-23 07:17:05,633 | INFO | [MA-SPI] Stage 1/3 - Q updates 4/10 (current batch 5000) [A0_Q_loss:0.6823, A1_Q_loss:1.0377]
2025-10-23 07:17:05,649 | INFO | [MA-SPI] Stage 1/3 - Q updates 6/10 (current batch 5000) [A0_Q_loss:1.0687, A1_Q_loss:1.3022]
2025-10-23 07:17:05,680 | INFO | [MA-SPI] Stage 1/3 - Q updates 8/10 (current batch 5000) [A0_Q_loss:1.3384, A1_Q_loss:1.1470]
2025-10-23 07:17:05,700 | INFO | [MA-SPI] Stage 1/3 - Q updates 10/10 (current batch 5000) [A0_Q_loss:1.2992, A1_Q_loss:1.0177]
2025-10-23 07:17:05,716 | INFO | [MA-SPI] Stage 1/3 - policy updates 1/5 (current batch 5000) [A0_Policy_loss:0.1837, A1_Policy_loss:0.0926]
2025-10-23 07:17:05,724 | INFO | [MA-SPI] Stage 1/3 - policy updates 2/5 (current batch 5000) [A0_Policy_loss:0.0791, A1_Policy_loss:0.0308]
2025-10-23 07:17:05,734 | INFO | [MA-SPI] Stage 1/3 - policy updates 3/5 (current batch 5000) [A0_Policy_loss:0.0342, A1_Policy_loss:0.0160]
2025-10-23 07:17:05,739 | INFO | [MA-SPI] Stage 1/3 - policy updates 4/5 (current batch 5000) [A0_Policy_loss:0.0242, A1_Policy_loss:0.0182]
2025-10-23 07:17:05,743 | INFO | [MA-SPI] Stage 1/3 - policy updates 5/5 (current batch 5000) [A0_Policy_loss:0.0272, A1_Policy_loss:0.0163]
2025-10-23 07:17:05,743 | INFO | [MA-SPI] Stage 1/3 - completed
2025-10-23 07:17:05,744 | INFO | [MA-SPI] Stage 2/3 - collecting trajectories...
2025-10-23 07:17:07,255 | INFO | [MA-SPI] Stage 2/3 - collected 10/50 episodes
2025-10-23 07:17:08,778 | INFO | [MA-SPI] Stage 2/3 - collected 20/50 episodes
2025-10-23 07:17:10,342 | INFO | [MA-SPI] Stage 2/3 - collected 30/50 episodes
2025-10-23 07:17:11,904 | INFO | [MA-SPI] Stage 2/3 - collected 40/50 episodes
2025-10-23 07:17:13,450 | INFO | [MA-SPI] Stage 2/3 - collected 50/50 episodes
2025-10-23 07:17:13,453 | INFO | [MA-SPI] Stage 2/3 - Agent 0 avg episode reward: -371.100 (std 29.228)
2025-10-23 07:17:13,454 | INFO | [MA-SPI] Stage 2/3 - Agent 1 avg episode reward: -383.980 (std 30.933)
2025-10-23 07:17:13,454 | INFO | [MA-SPI] Stage 2/3 - dataset size: 5000 transitions
2025-10-23 07:17:13,469 | INFO | [MA-SPI] Stage 2/3 - Q updates 2/10 (current batch 5000) [A0_Q_loss:1.6044, A1_Q_loss:1.3439]
2025-10-23 07:17:13,490 | INFO | [MA-SPI] Stage 2/3 - Q updates 4/10 (current batch 5000) [A0_Q_loss:1.4898, A1_Q_loss:1.6327]
2025-10-23 07:17:13,511 | INFO | [MA-SPI] Stage 2/3 - Q updates 6/10 (current batch 5000) [A0_Q_loss:1.5544, A1_Q_loss:1.5147]
2025-10-23 07:17:13,528 | INFO | [MA-SPI] Stage 2/3 - Q updates 8/10 (current batch 5000) [A0_Q_loss:1.5507, A1_Q_loss:1.1426]
2025-10-23 07:17:13,557 | INFO | [MA-SPI] Stage 2/3 - Q updates 10/10 (current batch 5000) [A0_Q_loss:1.2641, A1_Q_loss:0.9002]
2025-10-23 07:17:13,562 | INFO | [MA-SPI] Stage 2/3 - policy updates 1/5 (current batch 5000) [A0_Policy_loss:0.0774, A1_Policy_loss:0.0997]
2025-10-23 07:17:13,567 | INFO | [MA-SPI] Stage 2/3 - policy updates 2/5 (current batch 5000) [A0_Policy_loss:0.0634, A1_Policy_loss:0.0662]
2025-10-23 07:17:13,572 | INFO | [MA-SPI] Stage 2/3 - policy updates 3/5 (current batch 5000) [A0_Policy_loss:0.0483, A1_Policy_loss:0.0386]
2025-10-23 07:17:13,577 | INFO | [MA-SPI] Stage 2/3 - policy updates 4/5 (current batch 5000) [A0_Policy_loss:0.0360, A1_Policy_loss:0.0243]
2025-10-23 07:17:13,582 | INFO | [MA-SPI] Stage 2/3 - policy updates 5/5 (current batch 5000) [A0_Policy_loss:0.0257, A1_Policy_loss:0.0201]
2025-10-23 07:17:13,582 | INFO | [MA-SPI] Stage 2/3 - completed
2025-10-23 07:17:13,582 | INFO | [MA-SPI] Stage 3/3 - collecting trajectories...
2025-10-23 07:17:14,996 | INFO | [MA-SPI] Stage 3/3 - collected 10/50 episodes
2025-10-23 07:17:16,388 | INFO | [MA-SPI] Stage 3/3 - collected 20/50 episodes
2025-10-23 07:17:17,876 | INFO | [MA-SPI] Stage 3/3 - collected 30/50 episodes
2025-10-23 07:17:19,349 | INFO | [MA-SPI] Stage 3/3 - collected 40/50 episodes
2025-10-23 07:17:20,832 | INFO | [MA-SPI] Stage 3/3 - collected 50/50 episodes
2025-10-23 07:17:20,835 | INFO | [MA-SPI] Stage 3/3 - Agent 0 avg episode reward: -324.520 (std 29.781)
2025-10-23 07:17:20,835 | INFO | [MA-SPI] Stage 3/3 - Agent 1 avg episode reward: -332.060 (std 28.971)
2025-10-23 07:17:20,835 | INFO | [MA-SPI] Stage 3/3 - dataset size: 5000 transitions
2025-10-23 07:17:20,852 | INFO | [MA-SPI] Stage 3/3 - Q updates 2/10 (current batch 5000) [A0_Q_loss:0.9604, A1_Q_loss:0.9300]
2025-10-23 07:17:20,875 | INFO | [MA-SPI] Stage 3/3 - Q updates 4/10 (current batch 5000) [A0_Q_loss:1.3298, A1_Q_loss:1.0651]
2025-10-23 07:17:20,894 | INFO | [MA-SPI] Stage 3/3 - Q updates 6/10 (current batch 5000) [A0_Q_loss:1.3025, A1_Q_loss:0.9821]
2025-10-23 07:17:20,913 | INFO | [MA-SPI] Stage 3/3 - Q updates 8/10 (current batch 5000) [A0_Q_loss:1.0115, A1_Q_loss:0.8032]
2025-10-23 07:17:20,929 | INFO | [MA-SPI] Stage 3/3 - Q updates 10/10 (current batch 5000) [A0_Q_loss:0.7739, A1_Q_loss:0.7876]
2025-10-23 07:17:20,936 | INFO | [MA-SPI] Stage 3/3 - policy updates 1/5 (current batch 5000) [A0_Policy_loss:0.0786, A1_Policy_loss:0.0988]
2025-10-23 07:17:20,942 | INFO | [MA-SPI] Stage 3/3 - policy updates 2/5 (current batch 5000) [A0_Policy_loss:0.0658, A1_Policy_loss:0.0734]
2025-10-23 07:17:20,950 | INFO | [MA-SPI] Stage 3/3 - policy updates 3/5 (current batch 5000) [A0_Policy_loss:0.0511, A1_Policy_loss:0.0538]
2025-10-23 07:17:20,955 | INFO | [MA-SPI] Stage 3/3 - policy updates 4/5 (current batch 5000) [A0_Policy_loss:0.0378, A1_Policy_loss:0.0399]
2025-10-23 07:17:20,960 | INFO | [MA-SPI] Stage 3/3 - policy updates 5/5 (current batch 5000) [A0_Policy_loss:0.0292, A1_Policy_loss:0.0302]
2025-10-23 07:17:20,961 | INFO | [MA-SPI] Stage 3/3 - completed
2025-10-23 07:17:21,028 | INFO | [Experiment:homogeneous] MA-SPI completed. Artifacts saved to outputs\homogeneous\ma_spi
2025-10-23 07:17:21,028 | INFO | [Experiment:homogeneous] Starting MA-LfL...
2025-10-23 07:17:21,028 | INFO | [MA-LfL] Estimating policies...
2025-10-23 07:17:21,029 | INFO | [MA-LfL][Policy] Stage 1/3 - preparing data
2025-10-23 07:17:21,405 | INFO | [MA-LfL][Policy] Stage 1/3 - Agent 0: 10/10 epochs completed (loss=1.1188, baseline=1.6094)
2025-10-23 07:17:21,726 | INFO | [MA-LfL][Policy] Stage 1/3 - Agent 1: 10/10 epochs completed (loss=1.1085, baseline=1.6094)
2025-10-23 07:17:21,726 | INFO | [MA-LfL][Policy] Stage 2/3 - preparing data
2025-10-23 07:17:22,063 | INFO | [MA-LfL][Policy] Stage 2/3 - Agent 0: 10/10 epochs completed (loss=1.0595, baseline=1.6094)
2025-10-23 07:17:22,413 | INFO | [MA-LfL][Policy] Stage 2/3 - Agent 1: 10/10 epochs completed (loss=1.0989, baseline=1.6094)
2025-10-23 07:17:22,414 | INFO | [MA-LfL][Policy] Stage 3/3 - preparing data
2025-10-23 07:17:22,766 | INFO | [MA-LfL][Policy] Stage 3/3 - Agent 0: 10/10 epochs completed (loss=1.0900, baseline=1.6094)
2025-10-23 07:17:23,109 | INFO | [MA-LfL][Policy] Stage 3/3 - Agent 1: 10/10 epochs completed (loss=1.0585, baseline=1.6094)
2025-10-23 07:17:23,110 | INFO | [MA-LfL] Computing reward targets...
2025-10-23 07:17:23,110 | INFO | [MA-LfL][Targets] Stage 1/2 - Agent 0
2025-10-23 07:17:23,537 | INFO | [MA-LfL][Targets] Stage 1/2 - Agent 1
2025-10-23 07:17:23,973 | INFO | [MA-LfL][Targets] Stage 2/2 - Agent 0
2025-10-23 07:17:24,366 | INFO | [MA-LfL][Targets] Stage 2/2 - Agent 1
2025-10-23 07:17:24,769 | INFO | [MA-LfL] Learning rewards...
2025-10-23 07:17:24,778 | INFO | [MA-LfL][Reward] Agent 0 - dataset size=10000 (batch=512, epochs=1000)
2025-10-23 07:17:36,056 | INFO | [MA-LfL][Reward] Agent 0 - 100/1000 epochs completed (latest loss=0.0580)
2025-10-23 07:17:47,282 | INFO | [MA-LfL][Reward] Agent 0 - 200/1000 epochs completed (latest loss=0.0593)
2025-10-23 07:17:58,816 | INFO | [MA-LfL][Reward] Agent 0 - 300/1000 epochs completed (latest loss=0.0651)
2025-10-23 07:18:10,022 | INFO | [MA-LfL][Reward] Agent 0 - 400/1000 epochs completed (latest loss=0.0596)
2025-10-23 07:18:21,118 | INFO | [MA-LfL][Reward] Agent 0 - 500/1000 epochs completed (latest loss=0.0581)
2025-10-23 07:18:32,561 | INFO | [MA-LfL][Reward] Agent 0 - 600/1000 epochs completed (latest loss=0.0562)
2025-10-23 07:18:45,346 | INFO | [MA-LfL][Reward] Agent 0 - 700/1000 epochs completed (latest loss=0.0569)
2025-10-23 07:18:57,929 | INFO | [MA-LfL][Reward] Agent 0 - 800/1000 epochs completed (latest loss=0.0560)
2025-10-23 07:19:10,383 | INFO | [MA-LfL][Reward] Agent 0 - 900/1000 epochs completed (latest loss=0.0557)
2025-10-23 07:19:21,726 | INFO | [MA-LfL][Reward] Agent 0 - 1000/1000 epochs completed (latest loss=0.0539)
2025-10-23 07:19:21,737 | INFO | [MA-LfL][Reward] Agent 1 - dataset size=10000 (batch=512, epochs=1000)
2025-10-23 07:19:35,206 | INFO | [MA-LfL][Reward] Agent 1 - 100/1000 epochs completed (latest loss=0.1353)
2025-10-23 07:19:47,831 | INFO | [MA-LfL][Reward] Agent 1 - 200/1000 epochs completed (latest loss=0.1290)
2025-10-23 07:20:00,453 | INFO | [MA-LfL][Reward] Agent 1 - 300/1000 epochs completed (latest loss=0.1314)
2025-10-23 07:20:13,322 | INFO | [MA-LfL][Reward] Agent 1 - 400/1000 epochs completed (latest loss=0.1297)
2025-10-23 07:20:24,599 | INFO | [MA-LfL][Reward] Agent 1 - 500/1000 epochs completed (latest loss=0.1280)
2025-10-23 07:20:35,896 | INFO | [MA-LfL][Reward] Agent 1 - 600/1000 epochs completed (latest loss=0.1259)
2025-10-23 07:20:46,951 | INFO | [MA-LfL][Reward] Agent 1 - 700/1000 epochs completed (latest loss=0.1222)
2025-10-23 07:20:57,898 | INFO | [MA-LfL][Reward] Agent 1 - 800/1000 epochs completed (latest loss=0.1230)
2025-10-23 07:21:09,029 | INFO | [MA-LfL][Reward] Agent 1 - 900/1000 epochs completed (latest loss=0.1227)
2025-10-23 07:21:20,064 | INFO | [MA-LfL][Reward] Agent 1 - 1000/1000 epochs completed (latest loss=0.1236)
2025-10-23 07:21:20,065 | INFO | [MA-LfL] Evaluating rewards...
2025-10-23 07:21:20,839 | INFO | [MA-LfL] Pipeline complete.
2025-10-23 07:21:20,839 | INFO | [Experiment:homogeneous] MA-LfL completed. Artifacts saved to outputs\homogeneous\ma_lfl
2025-10-23 07:21:20,839 | INFO | [Experiment:homogeneous] Agent 0 metrics - Pearson: 0.0129 | Spearman: 0.0176
2025-10-23 07:21:20,839 | INFO | [Experiment:homogeneous] Agent 1 metrics - Pearson: -0.0277 | Spearman: -0.0491
2025-10-23 07:21:20,840 | INFO | [Experiment:homogeneous] Trend stages: 1, 2
2025-10-23 07:21:20,840 | INFO | [Experiment:homogeneous] Trend Pearson: -0.1516, -0.0849
2025-10-23 07:21:20,840 | INFO | [Experiment:homogeneous] Trend Spearman: -0.1104, -0.0929
2025-10-23 07:21:20,840 | INFO | [Experiment:homogeneous] Agent 0 correlation >=0.4 ? NO
2025-10-23 07:21:20,840 | INFO | [Experiment:homogeneous] Agent 1 correlation >=0.4 ? NO
2025-10-23 07:21:20,840 | INFO | [Experiment:homogeneous] Correlation trend non-decreasing? YES
2025-10-23 07:21:20,841 | INFO | Summary saved to outputs\summary.json
2025-10-23 07:21:20,842 | INFO | Run complete.
