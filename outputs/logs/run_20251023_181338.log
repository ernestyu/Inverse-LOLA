2025-10-23 18:13:38,974 | INFO | Logging initialized. Log file: outputs\logs\run_20251023_181338.log
2025-10-23 18:13:38,974 | INFO | Configuration file: config.yaml
2025-10-23 18:13:38,974 | INFO | Reward families to process: heterogeneous
2025-10-23 18:13:38,974 | INFO | MA-SPI iterations=10, episodes/stage=10, episode_length=100
2025-10-23 18:13:38,974 | INFO | MA-LfL reward epochs=10000, reward batch size=8192
2025-10-23 18:13:38,974 | INFO | Log file located at outputs\logs\run_20251023_181338.log
2025-10-23 18:13:38,975 | INFO | Running experiment for reward family: heterogeneous
2025-10-23 18:13:38,975 | INFO | [Experiment:heterogeneous] Starting MA-SPI...
2025-10-23 18:13:39,884 | INFO | [MA-SPI] Starting run with 10 stages, 10 episodes/stage, episode length 100
2025-10-23 18:13:39,897 | INFO | [MA-SPI] Stage 1/10 - collecting trajectories...
2025-10-23 18:13:40,349 | INFO | [MA-SPI] Stage 1/10 - collected 2/10 episodes
2025-10-23 18:13:40,611 | INFO | [MA-SPI] Stage 1/10 - collected 4/10 episodes
2025-10-23 18:13:40,887 | INFO | [MA-SPI] Stage 1/10 - collected 6/10 episodes
2025-10-23 18:13:41,168 | INFO | [MA-SPI] Stage 1/10 - collected 8/10 episodes
2025-10-23 18:13:41,452 | INFO | [MA-SPI] Stage 1/10 - collected 10/10 episodes
2025-10-23 18:13:41,453 | INFO | [MA-SPI] Stage 1/10 - Agent 0 avg episode reward: -137.400 (std 33.539)
2025-10-23 18:13:41,453 | INFO | [MA-SPI] Stage 1/10 - Agent 1 avg episode reward: -114.900 (std 35.184)
2025-10-23 18:13:41,453 | INFO | [MA-SPI] Stage 1/10 - dataset size: 1000 transitions
2025-10-23 18:13:41,702 | INFO | [MA-SPI] Stage 1/10 - Q updates 20/100 (current batch 1000) [A0_Q_loss:2.7630, A1_Q_loss:3.1812]
2025-10-23 18:13:41,793 | INFO | [MA-SPI] Stage 1/10 - Q updates 40/100 (current batch 1000) [A0_Q_loss:1.3751, A1_Q_loss:1.4296]
2025-10-23 18:13:41,891 | INFO | [MA-SPI] Stage 1/10 - Q updates 60/100 (current batch 1000) [A0_Q_loss:0.8376, A1_Q_loss:1.0367]
2025-10-23 18:13:41,980 | INFO | [MA-SPI] Stage 1/10 - Q updates 80/100 (current batch 1000) [A0_Q_loss:0.5093, A1_Q_loss:0.7529]
2025-10-23 18:13:42,074 | INFO | [MA-SPI] Stage 1/10 - Q updates 100/100 (current batch 1000) [A0_Q_loss:0.4704, A1_Q_loss:0.5672]
2025-10-23 18:13:42,117 | INFO | [MA-SPI] Stage 1/10 - policy updates 10/50 (current batch 1000) [A0_Policy_loss:0.0288, A1_Policy_loss:0.0183]
2025-10-23 18:13:42,159 | INFO | [MA-SPI] Stage 1/10 - policy updates 20/50 (current batch 1000) [A0_Policy_loss:0.0090, A1_Policy_loss:0.0042]
2025-10-23 18:13:42,197 | INFO | [MA-SPI] Stage 1/10 - policy updates 30/50 (current batch 1000) [A0_Policy_loss:0.0034, A1_Policy_loss:0.0015]
2025-10-23 18:13:42,236 | INFO | [MA-SPI] Stage 1/10 - policy updates 40/50 (current batch 1000) [A0_Policy_loss:0.0013, A1_Policy_loss:0.0006]
2025-10-23 18:13:42,273 | INFO | [MA-SPI] Stage 1/10 - policy updates 50/50 (current batch 1000) [A0_Policy_loss:0.0005, A1_Policy_loss:0.0002]
2025-10-23 18:13:42,273 | INFO | [MA-SPI] Stage 1/10 - completed
2025-10-23 18:13:42,273 | INFO | [MA-SPI] Stage 2/10 - collecting trajectories...
2025-10-23 18:13:42,552 | INFO | [MA-SPI] Stage 2/10 - collected 2/10 episodes
2025-10-23 18:13:42,860 | INFO | [MA-SPI] Stage 2/10 - collected 4/10 episodes
2025-10-23 18:13:43,212 | INFO | [MA-SPI] Stage 2/10 - collected 6/10 episodes
2025-10-23 18:13:43,525 | INFO | [MA-SPI] Stage 2/10 - collected 8/10 episodes
2025-10-23 18:13:43,800 | INFO | [MA-SPI] Stage 2/10 - collected 10/10 episodes
2025-10-23 18:13:43,801 | INFO | [MA-SPI] Stage 2/10 - Agent 0 avg episode reward: 67.000 (std 29.783)
2025-10-23 18:13:43,801 | INFO | [MA-SPI] Stage 2/10 - Agent 1 avg episode reward: 47.100 (std 20.535)
2025-10-23 18:13:43,801 | INFO | [MA-SPI] Stage 2/10 - dataset size: 1000 transitions
2025-10-23 18:13:43,893 | INFO | [MA-SPI] Stage 2/10 - Q updates 20/100 (current batch 1000) [A0_Q_loss:1.6607, A1_Q_loss:1.4316]
2025-10-23 18:13:43,990 | INFO | [MA-SPI] Stage 2/10 - Q updates 40/100 (current batch 1000) [A0_Q_loss:1.0833, A1_Q_loss:1.1384]
2025-10-23 18:13:44,091 | INFO | [MA-SPI] Stage 2/10 - Q updates 60/100 (current batch 1000) [A0_Q_loss:0.9357, A1_Q_loss:1.0149]
2025-10-23 18:13:44,185 | INFO | [MA-SPI] Stage 2/10 - Q updates 80/100 (current batch 1000) [A0_Q_loss:0.8746, A1_Q_loss:0.9769]
2025-10-23 18:13:44,281 | INFO | [MA-SPI] Stage 2/10 - Q updates 100/100 (current batch 1000) [A0_Q_loss:0.8530, A1_Q_loss:0.9853]
2025-10-23 18:13:44,319 | INFO | [MA-SPI] Stage 2/10 - policy updates 10/50 (current batch 1000) [A0_Policy_loss:0.0158, A1_Policy_loss:0.0072]
2025-10-23 18:13:44,356 | INFO | [MA-SPI] Stage 2/10 - policy updates 20/50 (current batch 1000) [A0_Policy_loss:0.0048, A1_Policy_loss:0.0025]
2025-10-23 18:13:44,396 | INFO | [MA-SPI] Stage 2/10 - policy updates 30/50 (current batch 1000) [A0_Policy_loss:0.0020, A1_Policy_loss:0.0010]
2025-10-23 18:13:44,436 | INFO | [MA-SPI] Stage 2/10 - policy updates 40/50 (current batch 1000) [A0_Policy_loss:0.0006, A1_Policy_loss:0.0004]
2025-10-23 18:13:44,472 | INFO | [MA-SPI] Stage 2/10 - policy updates 50/50 (current batch 1000) [A0_Policy_loss:0.0002, A1_Policy_loss:0.0002]
2025-10-23 18:13:44,472 | INFO | [MA-SPI] Stage 2/10 - completed
2025-10-23 18:13:44,472 | INFO | [MA-SPI] Stage 3/10 - collecting trajectories...
2025-10-23 18:13:44,778 | INFO | [MA-SPI] Stage 3/10 - collected 2/10 episodes
2025-10-23 18:13:45,086 | INFO | [MA-SPI] Stage 3/10 - collected 4/10 episodes
2025-10-23 18:13:45,366 | INFO | [MA-SPI] Stage 3/10 - collected 6/10 episodes
2025-10-23 18:13:45,636 | INFO | [MA-SPI] Stage 3/10 - collected 8/10 episodes
2025-10-23 18:13:45,921 | INFO | [MA-SPI] Stage 3/10 - collected 10/10 episodes
2025-10-23 18:13:45,922 | INFO | [MA-SPI] Stage 3/10 - Agent 0 avg episode reward: 113.400 (std 28.051)
2025-10-23 18:13:45,923 | INFO | [MA-SPI] Stage 3/10 - Agent 1 avg episode reward: 109.100 (std 25.137)
2025-10-23 18:13:45,923 | INFO | [MA-SPI] Stage 3/10 - dataset size: 1000 transitions
2025-10-23 18:13:46,020 | INFO | [MA-SPI] Stage 3/10 - Q updates 20/100 (current batch 1000) [A0_Q_loss:0.7991, A1_Q_loss:0.6151]
2025-10-23 18:13:46,129 | INFO | [MA-SPI] Stage 3/10 - Q updates 40/100 (current batch 1000) [A0_Q_loss:0.8251, A1_Q_loss:0.5328]
2025-10-23 18:13:46,229 | INFO | [MA-SPI] Stage 3/10 - Q updates 60/100 (current batch 1000) [A0_Q_loss:0.7463, A1_Q_loss:0.5244]
2025-10-23 18:13:46,359 | INFO | [MA-SPI] Stage 3/10 - Q updates 80/100 (current batch 1000) [A0_Q_loss:0.7612, A1_Q_loss:0.5156]
2025-10-23 18:13:46,477 | INFO | [MA-SPI] Stage 3/10 - Q updates 100/100 (current batch 1000) [A0_Q_loss:0.7643, A1_Q_loss:0.5197]
2025-10-23 18:13:46,526 | INFO | [MA-SPI] Stage 3/10 - policy updates 10/50 (current batch 1000) [A0_Policy_loss:0.0067, A1_Policy_loss:0.0051]
2025-10-23 18:13:46,570 | INFO | [MA-SPI] Stage 3/10 - policy updates 20/50 (current batch 1000) [A0_Policy_loss:0.0023, A1_Policy_loss:0.0019]
2025-10-23 18:13:46,651 | INFO | [MA-SPI] Stage 3/10 - policy updates 30/50 (current batch 1000) [A0_Policy_loss:0.0008, A1_Policy_loss:0.0007]
2025-10-23 18:13:46,694 | INFO | [MA-SPI] Stage 3/10 - policy updates 40/50 (current batch 1000) [A0_Policy_loss:0.0003, A1_Policy_loss:0.0002]
2025-10-23 18:13:46,733 | INFO | [MA-SPI] Stage 3/10 - policy updates 50/50 (current batch 1000) [A0_Policy_loss:0.0001, A1_Policy_loss:0.0001]
2025-10-23 18:13:46,733 | INFO | [MA-SPI] Stage 3/10 - completed
2025-10-23 18:13:46,733 | INFO | [MA-SPI] Stage 4/10 - collecting trajectories...
2025-10-23 18:13:47,026 | INFO | [MA-SPI] Stage 4/10 - collected 2/10 episodes
2025-10-23 18:13:47,313 | INFO | [MA-SPI] Stage 4/10 - collected 4/10 episodes
2025-10-23 18:13:47,610 | INFO | [MA-SPI] Stage 4/10 - collected 6/10 episodes
2025-10-23 18:13:47,901 | INFO | [MA-SPI] Stage 4/10 - collected 8/10 episodes
2025-10-23 18:13:48,183 | INFO | [MA-SPI] Stage 4/10 - collected 10/10 episodes
2025-10-23 18:13:48,184 | INFO | [MA-SPI] Stage 4/10 - Agent 0 avg episode reward: 112.800 (std 30.225)
2025-10-23 18:13:48,184 | INFO | [MA-SPI] Stage 4/10 - Agent 1 avg episode reward: 98.900 (std 33.721)
2025-10-23 18:13:48,185 | INFO | [MA-SPI] Stage 4/10 - dataset size: 1000 transitions
2025-10-23 18:13:48,292 | INFO | [MA-SPI] Stage 4/10 - Q updates 20/100 (current batch 1000) [A0_Q_loss:0.5955, A1_Q_loss:0.4295]
2025-10-23 18:13:48,378 | INFO | [MA-SPI] Stage 4/10 - Q updates 40/100 (current batch 1000) [A0_Q_loss:0.5255, A1_Q_loss:0.3559]
2025-10-23 18:13:48,469 | INFO | [MA-SPI] Stage 4/10 - Q updates 60/100 (current batch 1000) [A0_Q_loss:0.4722, A1_Q_loss:0.3525]
2025-10-23 18:13:48,561 | INFO | [MA-SPI] Stage 4/10 - Q updates 80/100 (current batch 1000) [A0_Q_loss:0.5347, A1_Q_loss:0.3298]
2025-10-23 18:13:48,663 | INFO | [MA-SPI] Stage 4/10 - Q updates 100/100 (current batch 1000) [A0_Q_loss:0.4735, A1_Q_loss:0.3408]
2025-10-23 18:13:48,706 | INFO | [MA-SPI] Stage 4/10 - policy updates 10/50 (current batch 1000) [A0_Policy_loss:0.0037, A1_Policy_loss:0.0032]
2025-10-23 18:13:48,744 | INFO | [MA-SPI] Stage 4/10 - policy updates 20/50 (current batch 1000) [A0_Policy_loss:0.0011, A1_Policy_loss:0.0010]
2025-10-23 18:13:48,783 | INFO | [MA-SPI] Stage 4/10 - policy updates 30/50 (current batch 1000) [A0_Policy_loss:0.0005, A1_Policy_loss:0.0005]
2025-10-23 18:13:48,823 | INFO | [MA-SPI] Stage 4/10 - policy updates 40/50 (current batch 1000) [A0_Policy_loss:0.0002, A1_Policy_loss:0.0002]
2025-10-23 18:13:48,863 | INFO | [MA-SPI] Stage 4/10 - policy updates 50/50 (current batch 1000) [A0_Policy_loss:0.0001, A1_Policy_loss:0.0001]
2025-10-23 18:13:48,863 | INFO | [MA-SPI] Stage 4/10 - completed
2025-10-23 18:13:48,864 | INFO | [MA-SPI] Stage 5/10 - collecting trajectories...
2025-10-23 18:13:49,129 | INFO | [MA-SPI] Stage 5/10 - collected 2/10 episodes
2025-10-23 18:13:49,395 | INFO | [MA-SPI] Stage 5/10 - collected 4/10 episodes
2025-10-23 18:13:49,673 | INFO | [MA-SPI] Stage 5/10 - collected 6/10 episodes
2025-10-23 18:13:49,992 | INFO | [MA-SPI] Stage 5/10 - collected 8/10 episodes
2025-10-23 18:13:50,293 | INFO | [MA-SPI] Stage 5/10 - collected 10/10 episodes
2025-10-23 18:13:50,294 | INFO | [MA-SPI] Stage 5/10 - Agent 0 avg episode reward: 115.500 (std 18.720)
2025-10-23 18:13:50,294 | INFO | [MA-SPI] Stage 5/10 - Agent 1 avg episode reward: 110.000 (std 23.422)
2025-10-23 18:13:50,295 | INFO | [MA-SPI] Stage 5/10 - dataset size: 1000 transitions
2025-10-23 18:13:50,388 | INFO | [MA-SPI] Stage 5/10 - Q updates 20/100 (current batch 1000) [A0_Q_loss:0.5018, A1_Q_loss:0.4675]
2025-10-23 18:13:50,479 | INFO | [MA-SPI] Stage 5/10 - Q updates 40/100 (current batch 1000) [A0_Q_loss:0.4171, A1_Q_loss:0.4131]
2025-10-23 18:13:50,566 | INFO | [MA-SPI] Stage 5/10 - Q updates 60/100 (current batch 1000) [A0_Q_loss:0.4285, A1_Q_loss:0.3537]
2025-10-23 18:13:50,656 | INFO | [MA-SPI] Stage 5/10 - Q updates 80/100 (current batch 1000) [A0_Q_loss:0.4103, A1_Q_loss:0.4335]
2025-10-23 18:13:50,749 | INFO | [MA-SPI] Stage 5/10 - Q updates 100/100 (current batch 1000) [A0_Q_loss:0.4163, A1_Q_loss:0.4042]
2025-10-23 18:13:50,789 | INFO | [MA-SPI] Stage 5/10 - policy updates 10/50 (current batch 1000) [A0_Policy_loss:0.0023, A1_Policy_loss:0.0031]
2025-10-23 18:13:50,831 | INFO | [MA-SPI] Stage 5/10 - policy updates 20/50 (current batch 1000) [A0_Policy_loss:0.0007, A1_Policy_loss:0.0012]
2025-10-23 18:13:50,872 | INFO | [MA-SPI] Stage 5/10 - policy updates 30/50 (current batch 1000) [A0_Policy_loss:0.0003, A1_Policy_loss:0.0005]
2025-10-23 18:13:50,917 | INFO | [MA-SPI] Stage 5/10 - policy updates 40/50 (current batch 1000) [A0_Policy_loss:0.0001, A1_Policy_loss:0.0002]
2025-10-23 18:13:50,962 | INFO | [MA-SPI] Stage 5/10 - policy updates 50/50 (current batch 1000) [A0_Policy_loss:0.0000, A1_Policy_loss:0.0001]
2025-10-23 18:13:50,962 | INFO | [MA-SPI] Stage 5/10 - completed
2025-10-23 18:13:50,962 | INFO | [MA-SPI] Stage 6/10 - collecting trajectories...
2025-10-23 18:13:51,289 | INFO | [MA-SPI] Stage 6/10 - collected 2/10 episodes
2025-10-23 18:13:51,609 | INFO | [MA-SPI] Stage 6/10 - collected 4/10 episodes
2025-10-23 18:13:51,929 | INFO | [MA-SPI] Stage 6/10 - collected 6/10 episodes
2025-10-23 18:13:52,233 | INFO | [MA-SPI] Stage 6/10 - collected 8/10 episodes
2025-10-23 18:13:52,540 | INFO | [MA-SPI] Stage 6/10 - collected 10/10 episodes
2025-10-23 18:13:52,542 | INFO | [MA-SPI] Stage 6/10 - Agent 0 avg episode reward: 111.300 (std 22.055)
2025-10-23 18:13:52,543 | INFO | [MA-SPI] Stage 6/10 - Agent 1 avg episode reward: 104.800 (std 22.578)
2025-10-23 18:13:52,543 | INFO | [MA-SPI] Stage 6/10 - dataset size: 1000 transitions
2025-10-23 18:13:52,646 | INFO | [MA-SPI] Stage 6/10 - Q updates 20/100 (current batch 1000) [A0_Q_loss:0.5051, A1_Q_loss:0.3768]
2025-10-23 18:13:52,748 | INFO | [MA-SPI] Stage 6/10 - Q updates 40/100 (current batch 1000) [A0_Q_loss:0.4425, A1_Q_loss:0.3440]
2025-10-23 18:13:52,838 | INFO | [MA-SPI] Stage 6/10 - Q updates 60/100 (current batch 1000) [A0_Q_loss:0.4251, A1_Q_loss:0.3452]
2025-10-23 18:13:52,951 | INFO | [MA-SPI] Stage 6/10 - Q updates 80/100 (current batch 1000) [A0_Q_loss:0.4251, A1_Q_loss:0.3251]
2025-10-23 18:13:53,040 | INFO | [MA-SPI] Stage 6/10 - Q updates 100/100 (current batch 1000) [A0_Q_loss:0.4150, A1_Q_loss:0.3366]
2025-10-23 18:13:53,078 | INFO | [MA-SPI] Stage 6/10 - policy updates 10/50 (current batch 1000) [A0_Policy_loss:0.0042, A1_Policy_loss:0.0036]
2025-10-23 18:13:53,117 | INFO | [MA-SPI] Stage 6/10 - policy updates 20/50 (current batch 1000) [A0_Policy_loss:0.0014, A1_Policy_loss:0.0011]
2025-10-23 18:13:53,154 | INFO | [MA-SPI] Stage 6/10 - policy updates 30/50 (current batch 1000) [A0_Policy_loss:0.0006, A1_Policy_loss:0.0004]
2025-10-23 18:13:53,192 | INFO | [MA-SPI] Stage 6/10 - policy updates 40/50 (current batch 1000) [A0_Policy_loss:0.0002, A1_Policy_loss:0.0002]
2025-10-23 18:13:53,231 | INFO | [MA-SPI] Stage 6/10 - policy updates 50/50 (current batch 1000) [A0_Policy_loss:0.0001, A1_Policy_loss:0.0000]
2025-10-23 18:13:53,231 | INFO | [MA-SPI] Stage 6/10 - completed
2025-10-23 18:13:53,232 | INFO | [MA-SPI] Stage 7/10 - collecting trajectories...
2025-10-23 18:13:53,511 | INFO | [MA-SPI] Stage 7/10 - collected 2/10 episodes
2025-10-23 18:13:53,799 | INFO | [MA-SPI] Stage 7/10 - collected 4/10 episodes
2025-10-23 18:13:54,075 | INFO | [MA-SPI] Stage 7/10 - collected 6/10 episodes
2025-10-23 18:13:54,348 | INFO | [MA-SPI] Stage 7/10 - collected 8/10 episodes
2025-10-23 18:13:54,637 | INFO | [MA-SPI] Stage 7/10 - collected 10/10 episodes
2025-10-23 18:13:54,638 | INFO | [MA-SPI] Stage 7/10 - Agent 0 avg episode reward: 112.200 (std 17.016)
2025-10-23 18:13:54,639 | INFO | [MA-SPI] Stage 7/10 - Agent 1 avg episode reward: 110.400 (std 13.640)
2025-10-23 18:13:54,639 | INFO | [MA-SPI] Stage 7/10 - dataset size: 1000 transitions
2025-10-23 18:13:54,751 | INFO | [MA-SPI] Stage 7/10 - Q updates 20/100 (current batch 1000) [A0_Q_loss:0.3966, A1_Q_loss:0.3459]
2025-10-23 18:13:54,835 | INFO | [MA-SPI] Stage 7/10 - Q updates 40/100 (current batch 1000) [A0_Q_loss:0.3994, A1_Q_loss:0.3222]
2025-10-23 18:13:54,925 | INFO | [MA-SPI] Stage 7/10 - Q updates 60/100 (current batch 1000) [A0_Q_loss:0.3788, A1_Q_loss:0.3118]
2025-10-23 18:13:55,011 | INFO | [MA-SPI] Stage 7/10 - Q updates 80/100 (current batch 1000) [A0_Q_loss:0.3923, A1_Q_loss:0.3204]
2025-10-23 18:13:55,098 | INFO | [MA-SPI] Stage 7/10 - Q updates 100/100 (current batch 1000) [A0_Q_loss:0.3790, A1_Q_loss:0.3209]
2025-10-23 18:13:55,133 | INFO | [MA-SPI] Stage 7/10 - policy updates 10/50 (current batch 1000) [A0_Policy_loss:0.0021, A1_Policy_loss:0.0020]
2025-10-23 18:13:55,168 | INFO | [MA-SPI] Stage 7/10 - policy updates 20/50 (current batch 1000) [A0_Policy_loss:0.0008, A1_Policy_loss:0.0007]
2025-10-23 18:13:55,206 | INFO | [MA-SPI] Stage 7/10 - policy updates 30/50 (current batch 1000) [A0_Policy_loss:0.0002, A1_Policy_loss:0.0003]
2025-10-23 18:13:55,239 | INFO | [MA-SPI] Stage 7/10 - policy updates 40/50 (current batch 1000) [A0_Policy_loss:0.0001, A1_Policy_loss:0.0001]
2025-10-23 18:13:55,275 | INFO | [MA-SPI] Stage 7/10 - policy updates 50/50 (current batch 1000) [A0_Policy_loss:0.0000, A1_Policy_loss:0.0001]
2025-10-23 18:13:55,275 | INFO | [MA-SPI] Stage 7/10 - completed
2025-10-23 18:13:55,276 | INFO | [MA-SPI] Stage 8/10 - collecting trajectories...
2025-10-23 18:13:55,534 | INFO | [MA-SPI] Stage 8/10 - collected 2/10 episodes
2025-10-23 18:13:55,807 | INFO | [MA-SPI] Stage 8/10 - collected 4/10 episodes
2025-10-23 18:13:56,102 | INFO | [MA-SPI] Stage 8/10 - collected 6/10 episodes
2025-10-23 18:13:56,387 | INFO | [MA-SPI] Stage 8/10 - collected 8/10 episodes
2025-10-23 18:13:56,647 | INFO | [MA-SPI] Stage 8/10 - collected 10/10 episodes
2025-10-23 18:13:56,648 | INFO | [MA-SPI] Stage 8/10 - Agent 0 avg episode reward: 111.400 (std 20.553)
2025-10-23 18:13:56,648 | INFO | [MA-SPI] Stage 8/10 - Agent 1 avg episode reward: 106.800 (std 16.600)
2025-10-23 18:13:56,649 | INFO | [MA-SPI] Stage 8/10 - dataset size: 1000 transitions
2025-10-23 18:13:56,737 | INFO | [MA-SPI] Stage 8/10 - Q updates 20/100 (current batch 1000) [A0_Q_loss:0.6310, A1_Q_loss:0.3693]
2025-10-23 18:13:56,829 | INFO | [MA-SPI] Stage 8/10 - Q updates 40/100 (current batch 1000) [A0_Q_loss:0.5427, A1_Q_loss:0.3515]
2025-10-23 18:13:56,924 | INFO | [MA-SPI] Stage 8/10 - Q updates 60/100 (current batch 1000) [A0_Q_loss:0.5552, A1_Q_loss:0.3263]
2025-10-23 18:13:57,011 | INFO | [MA-SPI] Stage 8/10 - Q updates 80/100 (current batch 1000) [A0_Q_loss:0.5566, A1_Q_loss:0.3243]
2025-10-23 18:13:57,113 | INFO | [MA-SPI] Stage 8/10 - Q updates 100/100 (current batch 1000) [A0_Q_loss:0.5693, A1_Q_loss:0.3171]
2025-10-23 18:13:57,160 | INFO | [MA-SPI] Stage 8/10 - policy updates 10/50 (current batch 1000) [A0_Policy_loss:0.0035, A1_Policy_loss:0.0028]
2025-10-23 18:13:57,200 | INFO | [MA-SPI] Stage 8/10 - policy updates 20/50 (current batch 1000) [A0_Policy_loss:0.0012, A1_Policy_loss:0.0008]
2025-10-23 18:13:57,238 | INFO | [MA-SPI] Stage 8/10 - policy updates 30/50 (current batch 1000) [A0_Policy_loss:0.0005, A1_Policy_loss:0.0003]
2025-10-23 18:13:57,298 | INFO | [MA-SPI] Stage 8/10 - policy updates 40/50 (current batch 1000) [A0_Policy_loss:0.0002, A1_Policy_loss:0.0001]
2025-10-23 18:13:57,364 | INFO | [MA-SPI] Stage 8/10 - policy updates 50/50 (current batch 1000) [A0_Policy_loss:0.0001, A1_Policy_loss:-0.0000]
2025-10-23 18:13:57,364 | INFO | [MA-SPI] Stage 8/10 - completed
2025-10-23 18:13:57,364 | INFO | [MA-SPI] Stage 9/10 - collecting trajectories...
2025-10-23 18:13:57,642 | INFO | [MA-SPI] Stage 9/10 - collected 2/10 episodes
2025-10-23 18:13:57,945 | INFO | [MA-SPI] Stage 9/10 - collected 4/10 episodes
2025-10-23 18:13:58,254 | INFO | [MA-SPI] Stage 9/10 - collected 6/10 episodes
2025-10-23 18:13:58,546 | INFO | [MA-SPI] Stage 9/10 - collected 8/10 episodes
2025-10-23 18:13:58,878 | INFO | [MA-SPI] Stage 9/10 - collected 10/10 episodes
2025-10-23 18:13:58,880 | INFO | [MA-SPI] Stage 9/10 - Agent 0 avg episode reward: 90.500 (std 34.109)
2025-10-23 18:13:58,880 | INFO | [MA-SPI] Stage 9/10 - Agent 1 avg episode reward: 96.400 (std 28.207)
2025-10-23 18:13:58,880 | INFO | [MA-SPI] Stage 9/10 - dataset size: 1000 transitions
2025-10-23 18:13:58,986 | INFO | [MA-SPI] Stage 9/10 - Q updates 20/100 (current batch 1000) [A0_Q_loss:0.5586, A1_Q_loss:0.7855]
2025-10-23 18:13:59,080 | INFO | [MA-SPI] Stage 9/10 - Q updates 40/100 (current batch 1000) [A0_Q_loss:0.4635, A1_Q_loss:0.7610]
2025-10-23 18:13:59,181 | INFO | [MA-SPI] Stage 9/10 - Q updates 60/100 (current batch 1000) [A0_Q_loss:0.4826, A1_Q_loss:0.7537]
2025-10-23 18:13:59,273 | INFO | [MA-SPI] Stage 9/10 - Q updates 80/100 (current batch 1000) [A0_Q_loss:0.4642, A1_Q_loss:0.7416]
2025-10-23 18:13:59,391 | INFO | [MA-SPI] Stage 9/10 - Q updates 100/100 (current batch 1000) [A0_Q_loss:0.4403, A1_Q_loss:0.7824]
2025-10-23 18:13:59,431 | INFO | [MA-SPI] Stage 9/10 - policy updates 10/50 (current batch 1000) [A0_Policy_loss:0.0032, A1_Policy_loss:0.0058]
2025-10-23 18:13:59,468 | INFO | [MA-SPI] Stage 9/10 - policy updates 20/50 (current batch 1000) [A0_Policy_loss:0.0014, A1_Policy_loss:0.0017]
2025-10-23 18:13:59,506 | INFO | [MA-SPI] Stage 9/10 - policy updates 30/50 (current batch 1000) [A0_Policy_loss:0.0004, A1_Policy_loss:0.0005]
2025-10-23 18:13:59,544 | INFO | [MA-SPI] Stage 9/10 - policy updates 40/50 (current batch 1000) [A0_Policy_loss:0.0001, A1_Policy_loss:0.0002]
2025-10-23 18:13:59,580 | INFO | [MA-SPI] Stage 9/10 - policy updates 50/50 (current batch 1000) [A0_Policy_loss:0.0000, A1_Policy_loss:0.0001]
2025-10-23 18:13:59,580 | INFO | [MA-SPI] Stage 9/10 - completed
2025-10-23 18:13:59,580 | INFO | [MA-SPI] Stage 10/10 - collecting trajectories...
2025-10-23 18:13:59,877 | INFO | [MA-SPI] Stage 10/10 - collected 2/10 episodes
2025-10-23 18:14:00,174 | INFO | [MA-SPI] Stage 10/10 - collected 4/10 episodes
2025-10-23 18:14:00,504 | INFO | [MA-SPI] Stage 10/10 - collected 6/10 episodes
2025-10-23 18:14:00,811 | INFO | [MA-SPI] Stage 10/10 - collected 8/10 episodes
2025-10-23 18:14:01,136 | INFO | [MA-SPI] Stage 10/10 - collected 10/10 episodes
2025-10-23 18:14:01,137 | INFO | [MA-SPI] Stage 10/10 - Agent 0 avg episode reward: 112.100 (std 17.581)
2025-10-23 18:14:01,137 | INFO | [MA-SPI] Stage 10/10 - Agent 1 avg episode reward: 110.900 (std 17.207)
2025-10-23 18:14:01,137 | INFO | [MA-SPI] Stage 10/10 - dataset size: 1000 transitions
2025-10-23 18:14:01,228 | INFO | [MA-SPI] Stage 10/10 - Q updates 20/100 (current batch 1000) [A0_Q_loss:0.3000, A1_Q_loss:0.7328]
2025-10-23 18:14:01,318 | INFO | [MA-SPI] Stage 10/10 - Q updates 40/100 (current batch 1000) [A0_Q_loss:0.3119, A1_Q_loss:0.6032]
2025-10-23 18:14:01,403 | INFO | [MA-SPI] Stage 10/10 - Q updates 60/100 (current batch 1000) [A0_Q_loss:0.3098, A1_Q_loss:0.5551]
2025-10-23 18:14:01,499 | INFO | [MA-SPI] Stage 10/10 - Q updates 80/100 (current batch 1000) [A0_Q_loss:0.3066, A1_Q_loss:0.5492]
2025-10-23 18:14:01,584 | INFO | [MA-SPI] Stage 10/10 - Q updates 100/100 (current batch 1000) [A0_Q_loss:0.3176, A1_Q_loss:0.5136]
2025-10-23 18:14:01,633 | INFO | [MA-SPI] Stage 10/10 - policy updates 10/50 (current batch 1000) [A0_Policy_loss:0.0026, A1_Policy_loss:0.0040]
2025-10-23 18:14:01,677 | INFO | [MA-SPI] Stage 10/10 - policy updates 20/50 (current batch 1000) [A0_Policy_loss:0.0008, A1_Policy_loss:0.0014]
2025-10-23 18:14:01,731 | INFO | [MA-SPI] Stage 10/10 - policy updates 30/50 (current batch 1000) [A0_Policy_loss:0.0004, A1_Policy_loss:0.0005]
2025-10-23 18:14:01,802 | INFO | [MA-SPI] Stage 10/10 - policy updates 40/50 (current batch 1000) [A0_Policy_loss:0.0002, A1_Policy_loss:0.0001]
2025-10-23 18:14:01,842 | INFO | [MA-SPI] Stage 10/10 - policy updates 50/50 (current batch 1000) [A0_Policy_loss:0.0001, A1_Policy_loss:0.0000]
2025-10-23 18:14:01,843 | INFO | [MA-SPI] Stage 10/10 - completed
2025-10-23 18:14:01,904 | INFO | [Experiment:heterogeneous] MA-SPI completed. Artifacts saved to outputs\heterogeneous\ma_spi
2025-10-23 18:14:01,905 | INFO | [Experiment:heterogeneous] Starting MA-LfL...
2025-10-23 18:14:01,905 | INFO | [MA-LfL] Estimating policies...
2025-10-23 18:14:01,905 | INFO | [MA-LfL][Policy] Stage 1/10 - preparing data
2025-10-23 18:14:01,955 | INFO | [MA-LfL][Policy] Stage 1/10 - Agent 0: 10/10 epochs completed (loss=1.0913, baseline=1.6094)
2025-10-23 18:14:01,983 | INFO | [MA-LfL][Policy] Stage 1/10 - Agent 1: 10/10 epochs completed (loss=1.0798, baseline=1.6094)
2025-10-23 18:14:01,983 | INFO | [MA-LfL][Policy] Stage 2/10 - preparing data
2025-10-23 18:14:02,014 | INFO | [MA-LfL][Policy] Stage 2/10 - Agent 0: 10/10 epochs completed (loss=0.9976, baseline=1.6094)
2025-10-23 18:14:02,058 | INFO | [MA-LfL][Policy] Stage 2/10 - Agent 1: 10/10 epochs completed (loss=0.9760, baseline=1.6094)
2025-10-23 18:14:02,058 | INFO | [MA-LfL][Policy] Stage 3/10 - preparing data
2025-10-23 18:14:02,111 | INFO | [MA-LfL][Policy] Stage 3/10 - Agent 0: 10/10 epochs completed (loss=0.9835, baseline=1.6094)
2025-10-23 18:14:02,149 | INFO | [MA-LfL][Policy] Stage 3/10 - Agent 1: 10/10 epochs completed (loss=1.0029, baseline=1.6094)
2025-10-23 18:14:02,150 | INFO | [MA-LfL][Policy] Stage 4/10 - preparing data
2025-10-23 18:14:02,175 | INFO | [MA-LfL][Policy] Stage 4/10 - Agent 0: 10/10 epochs completed (loss=1.0035, baseline=1.6094)
2025-10-23 18:14:02,202 | INFO | [MA-LfL][Policy] Stage 4/10 - Agent 1: 10/10 epochs completed (loss=1.0177, baseline=1.6094)
2025-10-23 18:14:02,202 | INFO | [MA-LfL][Policy] Stage 5/10 - preparing data
2025-10-23 18:14:02,225 | INFO | [MA-LfL][Policy] Stage 5/10 - Agent 0: 10/10 epochs completed (loss=1.0083, baseline=1.6094)
2025-10-23 18:14:02,251 | INFO | [MA-LfL][Policy] Stage 5/10 - Agent 1: 10/10 epochs completed (loss=1.0069, baseline=1.6094)
2025-10-23 18:14:02,251 | INFO | [MA-LfL][Policy] Stage 6/10 - preparing data
2025-10-23 18:14:02,278 | INFO | [MA-LfL][Policy] Stage 6/10 - Agent 0: 10/10 epochs completed (loss=1.0273, baseline=1.6094)
2025-10-23 18:14:02,302 | INFO | [MA-LfL][Policy] Stage 6/10 - Agent 1: 10/10 epochs completed (loss=1.0030, baseline=1.6094)
2025-10-23 18:14:02,302 | INFO | [MA-LfL][Policy] Stage 7/10 - preparing data
2025-10-23 18:14:02,336 | INFO | [MA-LfL][Policy] Stage 7/10 - Agent 0: 10/10 epochs completed (loss=1.0323, baseline=1.6094)
2025-10-23 18:14:02,362 | INFO | [MA-LfL][Policy] Stage 7/10 - Agent 1: 10/10 epochs completed (loss=1.0303, baseline=1.6094)
2025-10-23 18:14:02,363 | INFO | [MA-LfL][Policy] Stage 8/10 - preparing data
2025-10-23 18:14:02,391 | INFO | [MA-LfL][Policy] Stage 8/10 - Agent 0: 10/10 epochs completed (loss=1.0107, baseline=1.6094)
2025-10-23 18:14:02,414 | INFO | [MA-LfL][Policy] Stage 8/10 - Agent 1: 10/10 epochs completed (loss=1.0002, baseline=1.6094)
2025-10-23 18:14:02,414 | INFO | [MA-LfL][Policy] Stage 9/10 - preparing data
2025-10-23 18:14:02,443 | INFO | [MA-LfL][Policy] Stage 9/10 - Agent 0: 10/10 epochs completed (loss=1.0122, baseline=1.6094)
2025-10-23 18:14:02,467 | INFO | [MA-LfL][Policy] Stage 9/10 - Agent 1: 10/10 epochs completed (loss=1.0082, baseline=1.6094)
2025-10-23 18:14:02,467 | INFO | [MA-LfL][Policy] Stage 10/10 - preparing data
2025-10-23 18:14:02,491 | INFO | [MA-LfL][Policy] Stage 10/10 - Agent 0: 10/10 epochs completed (loss=1.0338, baseline=1.6094)
2025-10-23 18:14:02,516 | INFO | [MA-LfL][Policy] Stage 10/10 - Agent 1: 10/10 epochs completed (loss=0.9851, baseline=1.6094)
2025-10-23 18:14:02,516 | INFO | [MA-LfL] Computing reward targets...
2025-10-23 18:14:02,517 | INFO | [MA-LfL][Targets] Stage 1/9 - Agent 0
2025-10-23 18:14:02,925 | INFO | [MA-LfL][Targets] Stage 1/9 - Agent 1
2025-10-23 18:14:03,285 | INFO | [MA-LfL][Targets] Stage 2/9 - Agent 0
2025-10-23 18:14:03,671 | INFO | [MA-LfL][Targets] Stage 2/9 - Agent 1
2025-10-23 18:14:04,067 | INFO | [MA-LfL][Targets] Stage 3/9 - Agent 0
2025-10-23 18:14:04,434 | INFO | [MA-LfL][Targets] Stage 3/9 - Agent 1
2025-10-23 18:14:04,844 | INFO | [MA-LfL][Targets] Stage 4/9 - Agent 0
2025-10-23 18:14:05,270 | INFO | [MA-LfL][Targets] Stage 4/9 - Agent 1
2025-10-23 18:14:05,678 | INFO | [MA-LfL][Targets] Stage 5/9 - Agent 0
2025-10-23 18:14:06,088 | INFO | [MA-LfL][Targets] Stage 5/9 - Agent 1
2025-10-23 18:14:06,514 | INFO | [MA-LfL][Targets] Stage 6/9 - Agent 0
2025-10-23 18:14:06,926 | INFO | [MA-LfL][Targets] Stage 6/9 - Agent 1
2025-10-23 18:14:07,337 | INFO | [MA-LfL][Targets] Stage 7/9 - Agent 0
2025-10-23 18:14:07,771 | INFO | [MA-LfL][Targets] Stage 7/9 - Agent 1
2025-10-23 18:14:08,201 | INFO | [MA-LfL][Targets] Stage 8/9 - Agent 0
2025-10-23 18:14:08,623 | INFO | [MA-LfL][Targets] Stage 8/9 - Agent 1
2025-10-23 18:14:09,064 | INFO | [MA-LfL][Targets] Stage 9/9 - Agent 0
2025-10-23 18:14:09,490 | INFO | [MA-LfL][Targets] Stage 9/9 - Agent 1
2025-10-23 18:14:09,897 | INFO | [MA-LfL] Learning rewards...
2025-10-23 18:14:09,913 | INFO | [MA-LfL][Reward] Agent 0 - dataset size=9000 (batch=8192, epochs=10000)
2025-10-23 18:14:54,039 | INFO | [MA-LfL][Reward] Agent 0 - 1000/10000 epochs completed (latest loss=1.1185)
2025-10-23 18:15:36,815 | INFO | [MA-LfL][Reward] Agent 0 - 2000/10000 epochs completed (latest loss=1.1117)
2025-10-23 18:16:19,674 | INFO | [MA-LfL][Reward] Agent 0 - 3000/10000 epochs completed (latest loss=1.0939)
2025-10-23 18:17:02,883 | INFO | [MA-LfL][Reward] Agent 0 - 4000/10000 epochs completed (latest loss=1.1118)
2025-10-23 18:17:46,829 | INFO | [MA-LfL][Reward] Agent 0 - 5000/10000 epochs completed (latest loss=1.0634)
2025-10-23 18:18:30,104 | INFO | [MA-LfL][Reward] Agent 0 - 6000/10000 epochs completed (latest loss=1.1025)
2025-10-23 18:19:13,514 | INFO | [MA-LfL][Reward] Agent 0 - 7000/10000 epochs completed (latest loss=1.1931)
2025-10-23 18:19:54,244 | INFO | [MA-LfL][Reward] Agent 0 - 8000/10000 epochs completed (latest loss=1.0774)
2025-10-23 18:20:35,535 | INFO | [MA-LfL][Reward] Agent 0 - 9000/10000 epochs completed (latest loss=1.1059)
2025-10-23 18:21:16,929 | INFO | [MA-LfL][Reward] Agent 0 - 10000/10000 epochs completed (latest loss=1.1274)
2025-10-23 18:21:16,943 | INFO | [MA-LfL][Reward] Agent 1 - dataset size=9000 (batch=8192, epochs=10000)
2025-10-23 18:21:57,509 | INFO | [MA-LfL][Reward] Agent 1 - 1000/10000 epochs completed (latest loss=1.0083)
2025-10-23 18:22:38,084 | INFO | [MA-LfL][Reward] Agent 1 - 2000/10000 epochs completed (latest loss=1.0032)
2025-10-23 18:23:19,121 | INFO | [MA-LfL][Reward] Agent 1 - 3000/10000 epochs completed (latest loss=0.9655)
2025-10-23 18:24:00,561 | INFO | [MA-LfL][Reward] Agent 1 - 4000/10000 epochs completed (latest loss=1.1339)
2025-10-23 18:24:41,363 | INFO | [MA-LfL][Reward] Agent 1 - 5000/10000 epochs completed (latest loss=0.9290)
2025-10-23 18:25:22,697 | INFO | [MA-LfL][Reward] Agent 1 - 6000/10000 epochs completed (latest loss=1.0621)
2025-10-23 18:26:02,815 | INFO | [MA-LfL][Reward] Agent 1 - 7000/10000 epochs completed (latest loss=1.0817)
2025-10-23 18:26:44,180 | INFO | [MA-LfL][Reward] Agent 1 - 8000/10000 epochs completed (latest loss=1.0441)
2025-10-23 18:27:26,749 | INFO | [MA-LfL][Reward] Agent 1 - 9000/10000 epochs completed (latest loss=0.9615)
2025-10-23 18:28:07,965 | INFO | [MA-LfL][Reward] Agent 1 - 10000/10000 epochs completed (latest loss=1.0377)
2025-10-23 18:28:07,965 | INFO | [MA-LfL] Evaluating rewards...
2025-10-23 18:28:08,750 | INFO | [MA-LfL] Pipeline complete.
2025-10-23 18:28:08,750 | INFO | [Experiment:heterogeneous] MA-LfL completed. Artifacts saved to outputs\heterogeneous\ma_lfl
2025-10-23 18:28:08,750 | INFO | [Experiment:heterogeneous] Agent 0 metrics - Pearson: 0.1685 | Spearman: 0.1879
2025-10-23 18:28:08,751 | INFO | [Experiment:heterogeneous] Agent 1 metrics - Pearson: 0.1049 | Spearman: 0.0961
2025-10-23 18:28:08,751 | INFO | [Experiment:heterogeneous] Trend stages: 1, 2, 3, 4, 5, 6, 7, 8, 9
2025-10-23 18:28:08,751 | INFO | [Experiment:heterogeneous] Trend Pearson: 0.4034, 0.6917, 0.5595, 0.5787, 0.6148, 0.6194, 0.6608, 0.6435, 0.6792
2025-10-23 18:28:08,751 | INFO | [Experiment:heterogeneous] Trend Spearman: 0.4059, 0.6826, 0.6808, 0.5965, 0.5663, 0.6358, 0.5464, 0.7205, 0.6721
2025-10-23 18:28:08,751 | INFO | [Experiment:heterogeneous] Agent 0 correlation >=0.4 ? NO
2025-10-23 18:28:08,751 | INFO | [Experiment:heterogeneous] Agent 1 correlation >=0.4 ? NO
2025-10-23 18:28:08,751 | INFO | [Experiment:heterogeneous] Correlation trend non-decreasing? NO
2025-10-23 18:28:08,753 | INFO | Summary saved to outputs\summary.json
2025-10-23 18:28:08,753 | INFO | Run complete.
