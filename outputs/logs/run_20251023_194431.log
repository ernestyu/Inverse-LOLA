2025-10-23 19:44:31,664 | INFO | Logging initialized. Log file: outputs\logs\run_20251023_194431.log
2025-10-23 19:44:31,664 | INFO | Configuration file: config.yaml
2025-10-23 19:44:31,664 | INFO | Reward families to process: heterogeneous
2025-10-23 19:44:31,664 | INFO | MA-SPI iterations=3, episodes/stage=10, episode_length=100
2025-10-23 19:44:31,665 | INFO | MA-LfL reward epochs=20000, reward batch size=8192
2025-10-23 19:44:31,665 | INFO | Log file located at outputs\logs\run_20251023_194431.log
2025-10-23 19:44:31,665 | INFO | Running experiment for reward family: heterogeneous
2025-10-23 19:44:31,665 | INFO | [Experiment:heterogeneous] Starting MA-SPI...
2025-10-23 19:44:32,682 | INFO | [MA-SPI] Starting run with 3 stages, 10 episodes/stage, episode length 100
2025-10-23 19:44:32,694 | INFO | [MA-SPI] Stage 1/3 - collecting trajectories...
2025-10-23 19:44:33,171 | INFO | [MA-SPI] Stage 1/3 - collected 2/10 episodes
2025-10-23 19:44:33,455 | INFO | [MA-SPI] Stage 1/3 - collected 4/10 episodes
2025-10-23 19:44:33,732 | INFO | [MA-SPI] Stage 1/3 - collected 6/10 episodes
2025-10-23 19:44:34,027 | INFO | [MA-SPI] Stage 1/3 - collected 8/10 episodes
2025-10-23 19:44:34,323 | INFO | [MA-SPI] Stage 1/3 - collected 10/10 episodes
2025-10-23 19:44:34,324 | INFO | [MA-SPI] Stage 1/3 - Agent 0 avg episode reward: -137.400 (std 33.539)
2025-10-23 19:44:34,324 | INFO | [MA-SPI] Stage 1/3 - Agent 1 avg episode reward: -114.900 (std 35.184)
2025-10-23 19:44:34,324 | INFO | [MA-SPI] Stage 1/3 - dataset size: 1000 transitions
2025-10-23 19:44:34,574 | INFO | [MA-SPI] Stage 1/3 - Q updates 20/100 (current batch 1000) [A0_Q_loss:2.7630, A1_Q_loss:3.1812]
2025-10-23 19:44:34,664 | INFO | [MA-SPI] Stage 1/3 - Q updates 40/100 (current batch 1000) [A0_Q_loss:1.3751, A1_Q_loss:1.4296]
2025-10-23 19:44:34,772 | INFO | [MA-SPI] Stage 1/3 - Q updates 60/100 (current batch 1000) [A0_Q_loss:0.8376, A1_Q_loss:1.0367]
2025-10-23 19:44:34,862 | INFO | [MA-SPI] Stage 1/3 - Q updates 80/100 (current batch 1000) [A0_Q_loss:0.5093, A1_Q_loss:0.7529]
2025-10-23 19:44:34,952 | INFO | [MA-SPI] Stage 1/3 - Q updates 100/100 (current batch 1000) [A0_Q_loss:0.4704, A1_Q_loss:0.5672]
2025-10-23 19:44:34,993 | INFO | [MA-SPI] Stage 1/3 - policy updates 10/50 (current batch 1000) [A0_Policy_loss:0.0288, A1_Policy_loss:0.0183]
2025-10-23 19:44:35,035 | INFO | [MA-SPI] Stage 1/3 - policy updates 20/50 (current batch 1000) [A0_Policy_loss:0.0090, A1_Policy_loss:0.0042]
2025-10-23 19:44:35,075 | INFO | [MA-SPI] Stage 1/3 - policy updates 30/50 (current batch 1000) [A0_Policy_loss:0.0034, A1_Policy_loss:0.0015]
2025-10-23 19:44:35,114 | INFO | [MA-SPI] Stage 1/3 - policy updates 40/50 (current batch 1000) [A0_Policy_loss:0.0013, A1_Policy_loss:0.0006]
2025-10-23 19:44:35,152 | INFO | [MA-SPI] Stage 1/3 - policy updates 50/50 (current batch 1000) [A0_Policy_loss:0.0005, A1_Policy_loss:0.0002]
2025-10-23 19:44:35,152 | INFO | [MA-SPI] Stage 1/3 - completed
2025-10-23 19:44:35,152 | INFO | [MA-SPI] Stage 2/3 - collecting trajectories...
2025-10-23 19:44:35,441 | INFO | [MA-SPI] Stage 2/3 - collected 2/10 episodes
2025-10-23 19:44:35,736 | INFO | [MA-SPI] Stage 2/3 - collected 4/10 episodes
2025-10-23 19:44:36,017 | INFO | [MA-SPI] Stage 2/3 - collected 6/10 episodes
2025-10-23 19:44:36,306 | INFO | [MA-SPI] Stage 2/3 - collected 8/10 episodes
2025-10-23 19:44:36,626 | INFO | [MA-SPI] Stage 2/3 - collected 10/10 episodes
2025-10-23 19:44:36,627 | INFO | [MA-SPI] Stage 2/3 - Agent 0 avg episode reward: 67.000 (std 29.783)
2025-10-23 19:44:36,627 | INFO | [MA-SPI] Stage 2/3 - Agent 1 avg episode reward: 47.100 (std 20.535)
2025-10-23 19:44:36,628 | INFO | [MA-SPI] Stage 2/3 - dataset size: 1000 transitions
2025-10-23 19:44:36,729 | INFO | [MA-SPI] Stage 2/3 - Q updates 20/100 (current batch 1000) [A0_Q_loss:1.6607, A1_Q_loss:1.4316]
2025-10-23 19:44:36,823 | INFO | [MA-SPI] Stage 2/3 - Q updates 40/100 (current batch 1000) [A0_Q_loss:1.0833, A1_Q_loss:1.1384]
2025-10-23 19:44:36,910 | INFO | [MA-SPI] Stage 2/3 - Q updates 60/100 (current batch 1000) [A0_Q_loss:0.9357, A1_Q_loss:1.0149]
2025-10-23 19:44:37,002 | INFO | [MA-SPI] Stage 2/3 - Q updates 80/100 (current batch 1000) [A0_Q_loss:0.8746, A1_Q_loss:0.9769]
2025-10-23 19:44:37,096 | INFO | [MA-SPI] Stage 2/3 - Q updates 100/100 (current batch 1000) [A0_Q_loss:0.8530, A1_Q_loss:0.9853]
2025-10-23 19:44:37,150 | INFO | [MA-SPI] Stage 2/3 - policy updates 10/50 (current batch 1000) [A0_Policy_loss:0.0158, A1_Policy_loss:0.0072]
2025-10-23 19:44:37,189 | INFO | [MA-SPI] Stage 2/3 - policy updates 20/50 (current batch 1000) [A0_Policy_loss:0.0048, A1_Policy_loss:0.0025]
2025-10-23 19:44:37,228 | INFO | [MA-SPI] Stage 2/3 - policy updates 30/50 (current batch 1000) [A0_Policy_loss:0.0020, A1_Policy_loss:0.0010]
2025-10-23 19:44:37,265 | INFO | [MA-SPI] Stage 2/3 - policy updates 40/50 (current batch 1000) [A0_Policy_loss:0.0006, A1_Policy_loss:0.0004]
2025-10-23 19:44:37,302 | INFO | [MA-SPI] Stage 2/3 - policy updates 50/50 (current batch 1000) [A0_Policy_loss:0.0002, A1_Policy_loss:0.0002]
2025-10-23 19:44:37,302 | INFO | [MA-SPI] Stage 2/3 - completed
2025-10-23 19:44:37,302 | INFO | [MA-SPI] Stage 3/3 - collecting trajectories...
2025-10-23 19:44:37,591 | INFO | [MA-SPI] Stage 3/3 - collected 2/10 episodes
2025-10-23 19:44:37,886 | INFO | [MA-SPI] Stage 3/3 - collected 4/10 episodes
2025-10-23 19:44:38,176 | INFO | [MA-SPI] Stage 3/3 - collected 6/10 episodes
2025-10-23 19:44:38,455 | INFO | [MA-SPI] Stage 3/3 - collected 8/10 episodes
2025-10-23 19:44:38,823 | INFO | [MA-SPI] Stage 3/3 - collected 10/10 episodes
2025-10-23 19:44:38,824 | INFO | [MA-SPI] Stage 3/3 - Agent 0 avg episode reward: 113.400 (std 28.051)
2025-10-23 19:44:38,824 | INFO | [MA-SPI] Stage 3/3 - Agent 1 avg episode reward: 109.100 (std 25.137)
2025-10-23 19:44:38,824 | INFO | [MA-SPI] Stage 3/3 - dataset size: 1000 transitions
2025-10-23 19:44:38,947 | INFO | [MA-SPI] Stage 3/3 - Q updates 20/100 (current batch 1000) [A0_Q_loss:0.7991, A1_Q_loss:0.6151]
2025-10-23 19:44:39,105 | INFO | [MA-SPI] Stage 3/3 - Q updates 40/100 (current batch 1000) [A0_Q_loss:0.8251, A1_Q_loss:0.5328]
2025-10-23 19:44:39,205 | INFO | [MA-SPI] Stage 3/3 - Q updates 60/100 (current batch 1000) [A0_Q_loss:0.7463, A1_Q_loss:0.5244]
2025-10-23 19:44:39,299 | INFO | [MA-SPI] Stage 3/3 - Q updates 80/100 (current batch 1000) [A0_Q_loss:0.7612, A1_Q_loss:0.5156]
2025-10-23 19:44:39,399 | INFO | [MA-SPI] Stage 3/3 - Q updates 100/100 (current batch 1000) [A0_Q_loss:0.7643, A1_Q_loss:0.5197]
2025-10-23 19:44:39,443 | INFO | [MA-SPI] Stage 3/3 - policy updates 10/50 (current batch 1000) [A0_Policy_loss:0.0067, A1_Policy_loss:0.0051]
2025-10-23 19:44:39,488 | INFO | [MA-SPI] Stage 3/3 - policy updates 20/50 (current batch 1000) [A0_Policy_loss:0.0023, A1_Policy_loss:0.0019]
2025-10-23 19:44:39,537 | INFO | [MA-SPI] Stage 3/3 - policy updates 30/50 (current batch 1000) [A0_Policy_loss:0.0008, A1_Policy_loss:0.0007]
2025-10-23 19:44:39,579 | INFO | [MA-SPI] Stage 3/3 - policy updates 40/50 (current batch 1000) [A0_Policy_loss:0.0003, A1_Policy_loss:0.0002]
2025-10-23 19:44:39,622 | INFO | [MA-SPI] Stage 3/3 - policy updates 50/50 (current batch 1000) [A0_Policy_loss:0.0001, A1_Policy_loss:0.0001]
2025-10-23 19:44:39,623 | INFO | [MA-SPI] Stage 3/3 - completed
2025-10-23 19:44:39,647 | INFO | [Experiment:heterogeneous] MA-SPI completed. Artifacts saved to outputs\heterogeneous\ma_spi
2025-10-23 19:44:39,647 | INFO | [Experiment:heterogeneous] Starting MA-LfL...
2025-10-23 19:44:39,647 | INFO | [MA-LfL] Estimating policies...
2025-10-23 19:44:39,647 | INFO | [MA-LfL][Policy] Stage 1/3 - preparing data
2025-10-23 19:44:39,691 | INFO | [MA-LfL][Policy] Stage 1/3 - Agent 0: 10/10 epochs completed (loss=1.0913, baseline=1.6094)
2025-10-23 19:44:39,717 | INFO | [MA-LfL][Policy] Stage 1/3 - Agent 1: 10/10 epochs completed (loss=1.0798, baseline=1.6094)
2025-10-23 19:44:39,718 | INFO | [MA-LfL][Policy] Stage 2/3 - preparing data
2025-10-23 19:44:39,750 | INFO | [MA-LfL][Policy] Stage 2/3 - Agent 0: 10/10 epochs completed (loss=0.9976, baseline=1.6094)
2025-10-23 19:44:39,778 | INFO | [MA-LfL][Policy] Stage 2/3 - Agent 1: 10/10 epochs completed (loss=0.9760, baseline=1.6094)
2025-10-23 19:44:39,779 | INFO | [MA-LfL][Policy] Stage 3/3 - preparing data
2025-10-23 19:44:39,815 | INFO | [MA-LfL][Policy] Stage 3/3 - Agent 0: 10/10 epochs completed (loss=0.9835, baseline=1.6094)
2025-10-23 19:44:39,855 | INFO | [MA-LfL][Policy] Stage 3/3 - Agent 1: 10/10 epochs completed (loss=1.0029, baseline=1.6094)
2025-10-23 19:44:39,856 | INFO | [MA-LfL] Computing reward targets...
2025-10-23 19:44:39,856 | INFO | [MA-LfL][Targets] Stage 1/2 - Agent 0
2025-10-23 19:44:40,308 | INFO | [MA-LfL][Targets] Stage 1/2 - Agent 1
2025-10-23 19:44:40,828 | INFO | [MA-LfL][Targets] Stage 2/2 - Agent 0
2025-10-23 19:44:41,281 | INFO | [MA-LfL][Targets] Stage 2/2 - Agent 1
2025-10-23 19:44:41,772 | INFO | [MA-LfL] Learning rewards...
2025-10-23 19:44:41,777 | INFO | [MA-LfL][Reward] Agent 0 - dataset size=2000 (batch=2000, epochs=20000)
2025-10-23 19:44:57,665 | INFO | [MA-LfL][Reward] Agent 0 - 2000/20000 epochs completed (latest loss=0.3931)
2025-10-23 19:45:09,757 | INFO | [MA-LfL][Reward] Agent 0 - 4000/20000 epochs completed (latest loss=0.3806)
2025-10-23 19:45:21,832 | INFO | [MA-LfL][Reward] Agent 0 - 6000/20000 epochs completed (latest loss=0.3806)
2025-10-23 19:45:34,258 | INFO | [MA-LfL][Reward] Agent 0 - 8000/20000 epochs completed (latest loss=0.3806)
2025-10-23 19:45:46,334 | INFO | [MA-LfL][Reward] Agent 0 - 10000/20000 epochs completed (latest loss=0.3806)
2025-10-23 19:45:58,547 | INFO | [MA-LfL][Reward] Agent 0 - 12000/20000 epochs completed (latest loss=0.3807)
2025-10-23 19:46:10,699 | INFO | [MA-LfL][Reward] Agent 0 - 14000/20000 epochs completed (latest loss=0.3849)
2025-10-23 19:46:23,401 | INFO | [MA-LfL][Reward] Agent 0 - 16000/20000 epochs completed (latest loss=0.3806)
2025-10-23 19:46:37,227 | INFO | [MA-LfL][Reward] Agent 0 - 18000/20000 epochs completed (latest loss=0.3809)
2025-10-23 19:46:50,996 | INFO | [MA-LfL][Reward] Agent 0 - 20000/20000 epochs completed (latest loss=0.3806)
2025-10-23 19:46:51,000 | INFO | [MA-LfL][Reward] Agent 1 - dataset size=2000 (batch=2000, epochs=20000)
2025-10-23 19:47:03,329 | INFO | [MA-LfL][Reward] Agent 1 - 2000/20000 epochs completed (latest loss=0.2003)
2025-10-23 19:47:16,018 | INFO | [MA-LfL][Reward] Agent 1 - 4000/20000 epochs completed (latest loss=0.1997)
2025-10-23 19:47:28,193 | INFO | [MA-LfL][Reward] Agent 1 - 6000/20000 epochs completed (latest loss=0.2057)
2025-10-23 19:47:40,216 | INFO | [MA-LfL][Reward] Agent 1 - 8000/20000 epochs completed (latest loss=0.1993)
2025-10-23 19:47:52,571 | INFO | [MA-LfL][Reward] Agent 1 - 10000/20000 epochs completed (latest loss=0.1993)
2025-10-23 19:48:04,943 | INFO | [MA-LfL][Reward] Agent 1 - 12000/20000 epochs completed (latest loss=0.1993)
2025-10-23 19:48:17,244 | INFO | [MA-LfL][Reward] Agent 1 - 14000/20000 epochs completed (latest loss=0.1993)
2025-10-23 19:48:29,329 | INFO | [MA-LfL][Reward] Agent 1 - 16000/20000 epochs completed (latest loss=0.1993)
2025-10-23 19:48:42,279 | INFO | [MA-LfL][Reward] Agent 1 - 18000/20000 epochs completed (latest loss=0.1993)
2025-10-23 19:48:53,883 | INFO | [MA-LfL][Reward] Agent 1 - 20000/20000 epochs completed (latest loss=0.1993)
2025-10-23 19:48:53,883 | INFO | [MA-LfL] Evaluating rewards...
2025-10-23 19:48:54,632 | INFO | [MA-LfL] Pipeline complete.
2025-10-23 19:48:54,632 | INFO | [Experiment:heterogeneous] MA-LfL completed. Artifacts saved to outputs\heterogeneous\ma_lfl
2025-10-23 19:48:54,633 | INFO | [Experiment:heterogeneous] Agent 0 metrics - Pearson: 0.2324 | Spearman: 0.2205
2025-10-23 19:48:54,633 | INFO | [Experiment:heterogeneous] Agent 1 metrics - Pearson: 0.1666 | Spearman: 0.1407
2025-10-23 19:48:54,633 | INFO | [Experiment:heterogeneous] Trend stages: 1, 2
2025-10-23 19:48:54,633 | INFO | [Experiment:heterogeneous] Trend Pearson: 0.4034, 0.6917
2025-10-23 19:48:54,633 | INFO | [Experiment:heterogeneous] Trend Spearman: 0.4059, 0.6826
2025-10-23 19:48:54,633 | INFO | [Experiment:heterogeneous] Agent 0 correlation >=0.4 ? NO
2025-10-23 19:48:54,633 | INFO | [Experiment:heterogeneous] Agent 1 correlation >=0.4 ? NO
2025-10-23 19:48:54,633 | INFO | [Experiment:heterogeneous] Correlation trend non-decreasing? YES
2025-10-23 19:48:54,634 | INFO | Summary saved to outputs\summary.json
2025-10-23 19:48:54,634 | INFO | Run complete.
